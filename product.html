<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - Leke Vogue Enterprise</title>
    <meta name="description" content="View product details at Leke Vogue Enterprise.">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ’ƒ</text></svg>">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container header-inner">
            <a href="index.html" class="logo">Leke<span>Vogue</span></a>
            
            <nav>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="shop.html" class="active">Shop</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
            
            <div class="nav-icons">
                <div class="cart-icon" onclick="window.location.href='cart.html'">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                    <span class="cart-count">0</span>
                </div>
                <button class="mobile-menu-btn" onclick="this.classList.toggle('active'); document.querySelector('.nav-links').classList.toggle('active');" aria-label="Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <!-- Product Details Container -->
    <section class="product-details-container">
        <div class="container">
            <!-- Breadcrumb -->
            <div style="margin-bottom: 30px; color: var(--gray);">
                <a href="index.html">Home</a> / <a href="shop.html">Shop</a> / <span id="productCategory">Product</span>
            </div>
            
            <!-- Product Details Grid -->
            <div class="product-details" id="productDetails">
                <!-- Product will be rendered by JavaScript -->
                <div class="spinner" style="margin: 100px auto;"></div>
            </div>
        </div>
    </section>

    <!-- Related Products -->
    <section class="related-products">
        <div class="container">
            <h2>Related Products</h2>
            <div class="products-grid" id="relatedProducts">
                <!-- Related products will be rendered by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <h3>Leke<span>Vogue</span></h3>
                    <p>Your premier destination for premium fashion, shoes, bags, wigs, and hair bundles in Ghana.</p>
                    <div class="footer-social">
                        <a href="#" aria-label="Facebook">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
                            </svg>
                        </a>
                        <a href="#" aria-label="WhatsApp">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                            </svg>
                        </a>
                        <a href="#" aria-label="TikTok">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
                            </svg>
                        </a>
                    </div>
                </div>
                <div>
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="shop.html">Shop</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h4>Policies</h4>
                    <ul class="footer-links">
                        <li><a href="#">Cookie Policy</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms & Conditions</a></li>
                    </ul>
                </div>
                <div>
                    <h4>Contact</h4>
                    <ul class="footer-links">
                        <li><a href="tel:0500098510">0500098510</a></li>
                        <li><a href="mailto:info@lekevogue.shop">info@lekevogue.shop</a></li>
                        <li>Kumasi Tanoso, opposite Ahenfie</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>Â© 2026 Leke Vogue Enterprise. All Rights Reserved.</p>
                <p class="developer-credit">Developed By Dromor Narh</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/data.js"></script>
    <script src="js/main.js"></script>
    <script>
        // Product details state - store quantities for each variant
        let variantQuantities = {}; // { 'M': 5, 'L': 4, 'White': 3 }
        
        // Initialize product page with API data
        async function initProduct() {
            // Get product ID from URL
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');
            
            if (!productId) {
                window.location.href = 'shop.html';
                return;
            }
            
            try {
                // Get product from API
                const product = await getProductById(productId);
                
                if (!product) {
                    window.location.href = 'shop.html';
                    return;
                }
                
                // Update page title
                document.title = `${product.name} - Leke Vogue Enterprise`;
                document.getElementById('productCategory').textContent = product.category;
                
                // Render product details
                const productDetails = document.getElementById('productDetails');
                
                // Build all images array (cover + additional)
                const allImages = [product.image, ...(product.images || [])].filter((v, i, a) => a.indexOf(v) === i);
                
                // Build variants with quantity selectors if available
                const hasSizes = product.sizes && product.sizes.length > 0;
                const hasColors = product.colors && product.colors.length > 0;
                
                // Initialize variant quantities
                if (hasSizes) {
                    product.sizes.forEach(size => variantQuantities[`size_${size}`] = 0);
                }
                if (hasColors) {
                    product.colors.forEach(color => variantQuantities[`color_${color}`] = 0);
                }
                
                // Render sizes with quantity selectors if available
                const sizesHtml = hasSizes ? `
                    <div class="product-option-group">
                        <label>Select Sizes & Quantities:</label>
                        <div class="variant-quantity-grid">
                            ${product.sizes.map(size => `
                                <div class="variant-item">
                                    <span class="variant-name">${size}</span>
                                    <div class="quantity-controls small">
                                        <button type="button" onclick="updateVariantQuantity('size_${size}', -1)">-</button>
                                        <span id="qty_size_${size}">0</span>
                                        <button type="button" onclick="updateVariantQuantity('size_${size}', 1)">+</button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : '';
                
                // Render colors with quantity selectors if available
                const colorsHtml = hasColors ? `
                    <div class="product-option-group">
                        <label>Select Colors & Quantities:</label>
                        <div class="variant-quantity-grid">
                            ${product.colors.map(color => `
                                <div class="variant-item">
                                    <span class="variant-name">${color}</span>
                                    <div class="quantity-controls small">
                                        <button type="button" onclick="updateVariantQuantity('color_${color}', -1)">-</button>
                                        <span id="qty_color_${color}">0</span>
                                        <button type="button" onclick="updateVariantQuantity('color_${color}', 1)">+</button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : '';
                
                // Render dimensions if available (as read-only info)
                const dimensionsHtml = product.dimensions ? `
                    <div class="product-detail-item">
                        <span class="detail-label">Dimensions:</span>
                        <span class="detail-value">${product.dimensions}</span>
                    </div>
                ` : '';
                
                // Render stock status
                const stockStatus = product.stock > 0 
                    ? `<span class="in-stock">In Stock (${product.stock} available)</span>`
                    : `<span class="out-of-stock">Out of Stock</span>`;
                
                // Price display (show original price if on sale)
                const priceHtml = product.originalPrice && product.originalPrice > product.price
                    ? `<p class="price">${formatPrice(product.price)}</p>
                       <p class="original-price">Was: ${formatPrice(product.originalPrice)}</p>`
                    : `<p class="price">${formatPrice(product.price)}</p>`;
                
                productDetails.innerHTML = `
                    <div class="product-gallery">
                        <div class="main-image">
                            <img src="${allImages[0]}" alt="${product.name}" id="mainImage">
                        </div>
                        ${allImages.length > 1 ? `
                            <div class="thumbnail-grid">
                                ${allImages.map((img, index) => `
                                    <div class="thumbnail ${index === 0 ? 'active' : ''}" onclick="changeImage('${img}')">
                                        <img src="${img}" alt="${product.name}">
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                    <div class="product-info-details">
                        <h1>${product.name}</h1>
                        
                        ${product.brand ? `<p class="product-brand">Brand: ${product.brand}</p>` : ''}
                        ${product.subcategory ? `<p class="product-subcategory">${product.subcategory}</p>` : ''}
                        
                        ${priceHtml}
                        
                        <p class="product-description">${product.description}</p>
                        
                        <div class="product-meta">
                            <div class="product-detail-item">
                                <span class="detail-label">Category:</span>
                                <span class="detail-value">${product.category}</span>
                            </div>
                            <div class="product-detail-item">
                                <span class="detail-label">Availability:</span>
                                ${stockStatus}
                            </div>
                            ${dimensionsHtml}
                        </div>
                        
                        ${sizesHtml}
                        ${colorsHtml}
                        
                        <div class="selected-total">
                            <span>Total Quantity:</span>
                            <span id="totalSelectedQty">0</span>
                        </div>
                        
                        <div class="product-actions">
                            <button class="btn btn-primary btn-lg" onclick="addVariantsToCart('${product.id}')">Add to Cart</button>
                            <a href="shop.html" class="btn btn-outline btn-lg">Continue Shopping</a>
                        </div>
                    </div>
                `;
                
                // Render related products
                const relatedProducts = await getRelatedProducts(product.id, 4);
                const relatedContainer = document.getElementById('relatedProducts');
                if (relatedProducts && relatedProducts.length > 0) {
                    UI.renderProducts(relatedProducts, relatedContainer);
                } else {
                    relatedContainer.innerHTML = '<p class="text-center" style="grid-column: 1/-1;">No related products found</p>';
                }
                
                UI.init();
            } catch (error) {
                console.error('Error loading product:', error);
                document.getElementById('productDetails').innerHTML = '<p class="text-center">Error loading product. Please try again.</p>';
            }
        }
        
        // Initialize on page load
        initProduct();
        
        // Global functions for product details
        function updateVariantQuantity(variantKey, change) {
            const currentQty = variantQuantities[variantKey] || 0;
            const newQty = Math.max(0, currentQty + change);
            variantQuantities[variantKey] = newQty;
            
            // Update display
            const qtyElement = document.getElementById(`qty_${variantKey}`);
            if (qtyElement) {
                qtyElement.textContent = newQty;
            }
            
            // Update total
            updateTotalSelectedQty();
        }
        
        function updateTotalSelectedQty() {
            let total = 0;
            Object.values(variantQuantities).forEach(qty => {
                total += qty;
            });
            const totalElement = document.getElementById('totalSelectedQty');
            if (totalElement) {
                totalElement.textContent = total;
            }
        }
        
        function changeImage(src) {
            document.getElementById('mainImage').src = src;
            document.querySelectorAll('.thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
                if (thumb.querySelector('img').src === src) {
                    thumb.classList.add('active');
                }
            });
        }
        
        function addVariantsToCart(productId) {
            // Collect all variants with quantities
            const variants = [];
            
            for (const [key, qty] of Object.entries(variantQuantities)) {
                if (qty > 0) {
                    const parts = key.split('_');
                    const type = parts[0];
                    const value = parts.slice(1).join('_');
                    variants.push({ type, value, quantity: qty });
                }
            }
            
            if (variants.length === 0) {
                alert('Please select at least one item with quantity');
                return;
            }
            
            // Add each variant to cart
            variants.forEach(variant => {
                Cart.addItem(productId, variant.quantity, variant.value, variant.type);
            });
            
            setTimeout(() => window.location.href = 'cart.html', 1000);
        }
    </script>
</body>
</html>
